<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëÅÔ∏è OHIF Micro Viewer ‚Äî IMAIOS Style</title>
    <script src="https://unpkg.com/@ohif/viewer@4.12.22/dist/index.umd.js" crossorigin></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        #root {
            width: 100%;
            height: 100vh;
        }
        .imaios-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 9999;
            max-width: 300px;
        }
        .imaios-info h4 {
            margin: 0 0 10px 0;
            color: #e65100;
        }
        .imaios-info ul {
            padding-left: 20px;
            margin: 0;
        }
        .imaios-info li {
            margin: 5px 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="imaios-info">
        <h4>‚ÑπÔ∏è IMAIOS-Style Viewer</h4>
        <ul>
            <li>‚úÖ Aucune installation</li>
            <li>‚úÖ Tout se passe en local</li>
            <li>‚úÖ Confidentialit√© garantie</li>
            <li>‚ö†Ô∏è Usage non m√©dical</li>
        </ul>
    </div>
    <div id="root"></div>
    <script>
        const containerId = 'root';
        const componentRenderedOrUpdatedCallback = function() {
            console.log('OHIF Viewer rendu avec succ√®s');
            
            // ‚úÖ Charge automatiquement la premi√®re √©tude
            setTimeout(() => {
                const studyList = document.querySelector('.study-list');
                if (studyList) {
                    const firstStudy = studyList.querySelector('.list-item');
                    if (firstStudy) {
                        firstStudy.click();
                    }
                }
            }, 1000);
        };

        window.OHIFViewer.installViewer(
            {
                routerBasename: '/',
                servers: {
                    dicomWeb: [
                        {
                            name: 'Local DICOM',
                            wadoUriRoot: '/',
                            qidoRoot: '/',
                            wadoRoot: '/',
                            qidoSupportsIncludeField: false,
                            imageRendering: 'wadouri',
                            thumbnailRendering: 'wadouri',
                            enableStudyLazyLoad: true,
                        },
                    ],
                },
                showStudyList: true, // ‚úÖ Affiche la liste des √©tudes
                filterQueryParam: false,
                maxConcurrentMetadataRequests: 1,
                disableServersCache: true,
                studyPrefetcher: {
                    enabled: true,
                    order: 'closest',
                    displaySetCount: 3,
                    preventCache: false,
                    prefetchDisplaySetsTimeout: 1000,
                    maxNumPrefetchRequests: 1,
                    displayProgress: false,
                    includeActiveDisplaySet: true,
                },
            },
            containerId,
            componentRenderedOrUpdatedCallback
        );
    </script>
</body>
</html>